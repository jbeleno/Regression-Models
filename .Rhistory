qnorm(0.95, 1100, 75)
n <- 100
m <- cumsum(rnorm(n, 1100, 75))/(1:n)
m
plot(m)
pbinom(3, size = 5, prob = 0.5, lower.tail = FALSE)
n <- 100
pnorm(16, mean = 15, sd = 1) - pnorm(14, mean = 15, sd = 1)
cumsum(rnorm(1000, .5, sqrt(0.12)))/(1:1000)
ppois(10, 5*3)
setwd("~/")
setwd("~/Desktop/Statistical_Inference/Statistical-Inference")
source("hypotesis.R")
tamanhos()
source("hypotesis.R")
ChickWeightTest()
ChickWeightTest()
ChickWeightTest()
source("hypotesis.R")
ChickWeightTest()
x <- 1100 + c(-1, 1)*qt(.95, 9 - 1)*30/sqrt(9)
x
x <- 1100 + c(-1, 1)*qt(.975, 9 - 1)*30/sqrt(9)
x
x <- -2
ts <- qt(.975, 9 - 1)
ts
sd <- -(-2)*sqrt(9)/(c(-1, 1)*qt(.975, 9 - 1))
sd
sp <- sqrt(((10 - 1)*0.6 + (10 - 1)*0.68)/(10 + 10 - 2))
intervals <- 3 - c(-1, 1)*5*sp*sqrt(1/10 + 1/10)
intervals
intervals <- 3 - 5 + c(-1, 1)qt(.975, 10 + 10 - 2)*sp*sqrt(1/10 + 1/10)
intervals <- 3 - 5 + c(-1, 1)*qt(.975, 10 + 10 - 2)*sp*sqrt(1/10 + 1/10)
intervals
6 + 2*1.645/sqrt(100)
6 - 2*1.645/sqrt(100)
oldIntervals <- 6 + c(-1, 1)*2*1.645/sqrt(100)
newIntervals <- 5 + c(-1, 1)*.5*1.645/sqrt(100)
difference <- oldIntervals - newIntervals
difference
sp <- sqrt(((100 - 1)*2 + (100 - 1)*.5)/(100 + 100 - 2))
intervals <- 6 - 4 + c(-1, 1)*qt(.975, 100 + 100 - 2)*sp*sqrt(1/100 + 1/100)
intervals
sp <- sqrt(((100 - 1)*2^2 + (100 - 1)*.5^2)/(100 + 100 - 2))
intervals <- 6 - 4 + c(-1, 1)*qt(.975, 100 + 100 - 2)*sp*sqrt(1/100 + 1/100)
intervals
sp <- sqrt(((9 - 1)*1.5^2 + (9 - 1)*1.8^2)/(9 + 9 - 2))
intervals <- -3 - 1 + c(-1, 1)*qt(.95, 9 + 9 - 2)*sp*sqrt(1/9 + 1/9)
intervals
cls
source("power.R")
beta()
source("power.R")
beta()
source("power.R")
ejemplo1()
source("power.R")
ejemplo1()
source("power.R")
ejemplo1()
source("multipleTest.R")
ejemplo1()
source("multipleTest.R")
ejemplo1()
source("resampling.R")
ejemplo1()
source("resampling.R")
ejemplo1()
ejemplo1()
source("resampling.R")
ejemplo1()
source("resampling.R")
ejemplo1()
x <- c(140, 138, 150, 148, 135)
y <- c(132, 135, 151, 146, 130)
t.test(x,y)
t.test(x,y, paired = TRUE)
1100 + c(-1, 1)*qt(.975, 9 - 1)*30/sqrt(9)
pbinom(2, size = 4, prob = 0.5, lower.tail = FALSE)
z <- ppois(9, 0.01*1787, lower.tail = FALSE)
Z
z
1 - z
z <- ppois(9, 0.01*1787)
z
sp <- sqrt(((9 - 1)*1.5^2 + (9 - 1)*1.8^2)/(9 + 9 - 2))
intervals <- -3 - 1 + c(-1, 1)*qt(.95, 9 + 9 - 2)*sp*sqrt(1/9 + 1/9)
intervals
power.t.test(n = 100, delta = 0.01, sd = 0.04, type = "one.sample", alt="one.sided")
power.t.test(delta = 0.01, sd = 0.04, power = 0.9)
power.t.test(delta = 0.01, sd = 0.04, power = 0.9, type = "one.sample", alt = "one.sided")
power.t.test(delta = 0.01, sd = 0.04, power = 0.9, type = "one.sample", alt = "one.sided", sig.level = 0.05)
hist(runif(1000))
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(runif(40)))
hist(mns)
rexp(1, 0.2)
rexp(2, 0.2)
rexp(40, 0.2)
rexp(40, 0.2)
plot(rexp(40, 0.2))
plot(rexp(40, 0.2))
plot(rexp(40, 0.2))
plot(rexp(40, 0.2))
plot(rexp(40, 0.2))
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(40, 0.2)))
hist(mns)
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(40, 0.2)))
hist(mns)
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(40, 0.2)))
hist(mns)
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(40, 0.2)))
hist(mns)
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(40, 0.2)))
hist(mns)
hist(mns)
var(mns)
source("asintotas.R")
source("asintotas.R")
project1()
source("asintotas.R")
project1()
source("asintotas.R")
project1()
source("asintotas.R")
project1()
source("asintotas.R")
project1()
source("asintotas.R")
project1()
project1()
project1()
project1()
project1()
project1()
project1()
library(twitteR)
library(twitteR)
library(twitteR)
library(twitteR)
library(twitteR)
getTwitterOAuth("pb0oyPmCpcQqAeaYe8aEXC0Mx", "Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K")
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
setup_twitter_oauth( consumer_key,
consumer_secret,
access_token,
access_secret)
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
setup_twitter_oauth( consumer_key,
consumer_secret,
access_token,
access_secret)
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
setup_twitter_oauth( consumer_key,
consumer_secret,
NULL,
NULL)
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
setup_twitter_oauth( consumer_key,
consumer_secret,
NULL,
NULL)
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
setup_twitter_oauth( consumer_key,
consumer_secret,
NULL,
NULL)
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
setup_twitter_oauth( consumer_key,
consumer_secret,
access_token,
access_secret)
r_stats <- searchTwitter("bihar", n = 150, lang="en", since="2014-08-20")
length(r_stats)
zika_data <- searchTwitter("zika", since="2014-01-01", n = 10000,
geocode='-10.012130, -52.207031,2200km')
zika_data <- searchTwitter("zika", since = "2014-01-01", until = "2015-01-01",
n = 10000,geocode = '-10.012130,-52.207031,2200km')
searchTwitter('apartment hunting', geocode='40.7361,-73.9901,5mi',  n=5000, retryOnRateLimit=1)
zika_data <- searchTwitter("zika", since = "2014-01-01", until = "2015-01-01",
n = 10000,geocode = '-10.012130,-52.207031,2200km',
retryOnRateLimit = 1)
length(zika_data)
zika_data <- searchTwitter("sismo", since = "2014-01-01", until = "2016-01-01",
n = 10000,
retryOnRateLimit = 1)
zika_data <- searchTwitter("#sismo", since = "2014-01-01", until = "2016-01-01",
n = 10000,
retryOnRateLimit = 1)
zika_data <- searchTwitter("#sismo", n=10)
zika_data <- searchTwitter("sismo", n=10)
length(zika_data)
zika_data
install.packages("streamR", "RCurl", "ROAuth", "RJSONIO")
library(streamR)
library(RCurl)
library(RJSONIO)
library(stringr)
requestURL <- "https://api.twitter.com/oauth/request_token"
accessURL <- "https://api.twitter.com/oauth/access_token"
authURL <- "https://api.twitter.com/oauth/authorize"
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
# access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
# access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
my_oauth <- OAuthFactory$new(consumerKey = consumerKey,
consumerSecret = consumerSecret,
requestURL = requestURL,
accessURL = accessURL,
authURL = authURL)
my_oauth$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
library(streamR)
library(RCurl)
library(RJSONIO)
library(stringr)
requestURL <- "https://api.twitter.com/oauth/request_token"
accessURL <- "https://api.twitter.com/oauth/access_token"
authURL <- "https://api.twitter.com/oauth/authorize"
consumer_key <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumer_secret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
# access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
# access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
my_oauth <- OAuthFactory$new(consumerKey = consumerKey,
consumerSecret = consumerSecret,
requestURL = requestURL,
accessURL = accessURL,
authURL = authURL)
my_oauth$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
requestURL <- "https://api.twitter.com/oauth/request_token"
accessURL <- "https://api.twitter.com/oauth/access_token"
authURL <- "https://api.twitter.com/oauth/authorize"
consumerKey <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumerSecret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
# access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
# access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
my_oauth <- OAuthFactory$new(consumerKey = consumerKey,
consumerSecret = consumerSecret,
requestURL = requestURL,
accessURL = accessURL,
authURL = authURL)
my_oauth$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
library(twitteR)
requestURL <- "https://api.twitter.com/oauth/request_token"
accessURL <- "https://api.twitter.com/oauth/access_token"
authURL <- "https://api.twitter.com/oauth/authorize"
consumerKey <- 'pb0oyPmCpcQqAeaYe8aEXC0Mx'
consumerSecret <- 'Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K'
# access_token <- '1888676370-GOsN7ny4FqoGdit6Y4gGN3kdtJJr0uCyMY3RpkT'
# access_secret <- 'B1lpwy1gmTwD9haGqJUOQEILZp3BcVJjojYHNhrZi5a1n'
my_oauth <- OAuthFactory$new(consumerKey = consumerKey,
consumerSecret = consumerSecret,
requestURL = requestURL,
accessURL = accessURL,
authURL = authURL)
my_oauth$handshake(cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
source("zika_getting_data.R")
twitterAuthentication()
save(my_oauth, file = "my_oauth.Rdata")
library(ROAuth)
requestURL <- "https://api.twitter.com/oauth/request_token"
accessURL <- "https://api.twitter.com/oauth/access_token"
authURL <- "https://api.twitter.com/oauth/authorize"
consumerKey <- "pb0oyPmCpcQqAeaYe8aEXC0Mx"
consumerSecret <- "Y02xtokn8ncpG4XfbSD7MH4lyqlWXY0iUKnF8NNdZ2BTq8lQ6K"
my_oauth <- OAuthFactory$new(consumerKey = consumerKey,
consumerSecret = consumerSecret,
requestURL = requestURL,
accessURL = accessURL,
authURL = authURL)
my_oauth$handshake(cainfo = system.file("CurlSSL", "cacert.pem",
package = "RCurl"))
save(my_oauth, file = "my_oauth.Rdata")
library(streamR)
load("my_oauth.Rdata")
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100,
location = c(3.294082, -73.300781, -33.614619, -29.707031),
timeout = 60,
oauth = my_oauth)
library(streamR)
load("my_oauth.Rdata")
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100,
location = c(3.294082, -73.300781, -33.614619, -29.707031),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c( -73.300781, 3.294082, -29.707031, -33.614619),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c(-73.300781,3.294082,-29.707031,-33.614619),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c(-29.707031,-33.614619,-73.300781,3.294082),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c(-29.707031,-33.614619,-73.300781,3.294082),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c(-122.75,36.8,-121.75,37.8),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c(-29.707031,3.294082,-73.300781,-33.614619),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika"),
tweets = 100, #long,lat
location = c(-73.300781,-33.614619,-29.707031,3.294082),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = c("zika", "sika"),
tweets = 100, #long,lat
location = c(-73.300781,-33.614619,-29.707031,3.294082),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = "zika",
tweets = 100, #long,lat
location = c(-73.300781,-33.614619,-29.707031,3.294082),
timeout = 60,
oauth = my_oauth)
filterStream(file.name = "tweets.json",
track = "zika",
tweets = 100, #long,lat
location = c(-73.300781,-33.614619,-29.707031,3.294082),
timeout = 60,
oauth = my_oauth)
setwd("~/Desktop/Regression-Models")
source("linear_least_squares.R")
source("linear_least_sqares.R")
newGraphic()
source("linear_least_squares.R")
newGraphic()
source("linear_regression_models.R")
function1()
library(UsingR)
data(diamond)
library(ggplot2)
fit <- lm(price ~ carat, data = diamond)
coef(fit)
fit2 <- lm(price ~ I(carat - mean(carat)), data = diamond)
coef(fit2)
fit3 <- lm(price ~ I(carat * 10), data = diamond)
coef(fit3)
residualsInXLine <- function(){}
library(UsingR)
data(diamond)
library(ggplot2)
diamond$e <- resid(lm(price ~ carat, data = diamond))
g = ggplot(diamond, aes(x = carat, y = e))
g = g + xlab("Mass (carats)")
g = g + ylab("Residual price (SIN $)")
g = g + geom_hline(yintercept = 0, size = 2)
g = g + geom_point(size = 7, colour = "black", alpha=0.5)
g = g + geom_point(size = 5, colour = "blue", alpha=0.2)
g
e = c(resid(lm(price ~ 1, data = diamond)),
resid(lm(price ~ carat, data = diamond)))
fit = factor(c(rep("Itc", nrow(diamond)),
rep("Itc, slope", nrow(diamond))))
g = ggplot(data.frame(e = e, fit = fit), aes(y = e, x = fit, fill = fit))
g = g + geom_dotplot(binaxis = "y", size = 2, stackdir = "center", binwidth = 20)
g = g + xlab("Fitting approach")
g = g + ylab("Residual price")
g
e = c(resid(lm(price ~ 1, data = diamond)),
resid(lm(price ~ carat, data = diamond)))
fit = factor(c(rep("Itc", nrow(diamond)),
rep("Itc, slope", nrow(diamond))))
g = ggplot(data.frame(e = e, fit = fit), aes(y = e, x = fit, fill = fit))
g = g + geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 20)
g = g + xlab("Fitting approach")
g = g + ylab("Residual price")
g
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
fit <- lm(y ~ x)
fit
summary(fit)
data("mtcars")
data("mtcars")
fit <- lm(mpg ~ wt, data = mtcars)
x <- c(mean(mtcars$wt))
predict(fit, newdata = data.frame(wt = x))
predict(fit, newdata = data.frame(wt = x), interval = ("confidence"))
mtcars$hp
summary(mtcars)
mtcars -help
mtcars -h
summary(fit)
x
x <- c(3)
predict(fit, newdata = data.frame(wt = x), interval = ("prediction"))
data("mtcars")
fit <- lm(mpg ~ I(wt/2), data = mtcars)
summary(fit)$coefficients
sumCoeff <- summary(fit)$coefficients
sumCoef[1,1] + c(-1, 1) * qt(.975, df = fit$df) * sumCoef[1, 2]
sumCoef <- summary(fit)$coefficients
sumCoef[1,1] + c(-1, 1) * qt(.975, df = fit$df) * sumCoef[1, 2]
sumCoef[2,1] + c(-1, 1) * qt(.975, df = fit$df) * sumCoef[2, 2]
fit <- lm(mpg ~ wt, data = mtcars)
coef(fit)
fit
summary(fit)
source("multivariable2.R")
info()
quickCorrelations()
install.packages(GGally)
install.packages("GGally")
quickCorrelations()
help("wrap", package = "GGally")
source("multivariable2.R")
quickCorrelations()
summary(lm(Fertility ~ . , data = swiss))$coefficients
n <- 100; x2 <- 1 : n; x1 <- .01 * x2 + runif(n, -.1, .1); y = -x1 + x2 + rnorm(n, sd = .01)
summary(lm(y ~ x1))$coef
n <- 100; x2 <- 1 : n; x1 <- .01 * x2 + runif(n, -.1, .1); y = -x1 + x2 + rnorm(n, sd = .01)
summary(lm(y ~ .))$coef
source("multivariable2.R")
plotExample1(y, x1, x2)
source("multivariable2.R")
plotResidualsExample1(x2, ey, ex1)
source("multivariable2.R")
plotResidualsExample1(dat)
dat = data.frame(y = y, x1 = x1, x2 = x2, ey = resid(lm(y ~ x2)), ex1 = resid(lm(x1 ~ x2)))
plotResidualsExample1(dat)
source("multivariable2.R")
unnecesaryVariables()
source("multivariable2.R")
plotExample2()
summary(lm(count ~ spray, data = InsectSprays))$coef
summary(lm(count ~ spray - 1, data = InsectSprays))$coef
library(dplyr)
summarise(group_by(InsectSprays, spray), mn = mean(count))
source("multivariable3.R")
swiss = mutate(swiss, CatholicBin = 1 * (Catholic > 50))
plotBinaryData(swiss)
fit = lm(Fertility ~ Agriculture + factor(CatholicBin), data = swiss)
g1 = g
g1 = g1 + geom_abline(intercept = coef(fit)[1], slope = coef(fit)[2], size = 2)
g1 = g1 + geom_abline(intercept = coef(fit)[1] + coef(fit)[3], slope = coef(fit)[2], size = 2)
g1
g1 = g
g1 = g1 + geom_abline(intercept = coef(fit)[1], slope = coef(fit)[2], size = 2)
g1
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBin)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
g1 = g
g1 = g1 + geom_abline(intercept = coef(fit)[1], slope = coef(fit)[2], size = 2)
g1
fit = lm(Fertility ~ Agriculture + factor(CatholicBin), data = swiss)
g1 = g
g1 = g1 + geom_abline(intercept = coef(fit)[1], slope = coef(fit)[2], size = 2)
g1 = g1 + geom_abline(intercept = coef(fit)[1] + coef(fit)[3], slope = coef(fit)[2], size = 2)
g1
summary(lm(Fertility ~ Agriculture + factor(CatholicBin), data = swiss))$coef
summary(lm(Fertility ~ Agriculture * factor(CatholicBin), data = swiss))$coef
fit = lm(Fertility ~ Agriculture * factor(CatholicBin), data = swiss)
g1 = g
g1 = g1 + geom_abline(intercept = coef(fit)[1], slope = coef(fit)[2], size = 2)
g1 = g1 + geom_abline(intercept = coef(fit)[1] + coef(fit)[3],
slope = coef(fit)[2] + coef(fit)[4], size = 2)
g1
summary(lm(Fertility ~ Agriculture + Agriculture : factor(CatholicBin), data = swiss))$coef
